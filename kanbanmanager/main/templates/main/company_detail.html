{% extends 'main/base.html' %}
{% block title %}{{ company.name }}{% endblock %}

{% block content %}
<div class="container py-4" style="max-width:700px;">

  {# ‚Äî‚Äî‚Äî‚Äî‚Äî –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞–¥ –∫–æ–º–ø–∞–Ω–∏–µ–π ‚Äî‚Äî‚Äî‚Äî‚Äî #}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="m-0">{{ company.name }}</h1>
    <div class="btn-group">
      <a href="{% url 'main:edit_company' company.pk %}"
         class="btn btn-sm btn-outline-primary">
        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
      </a>
      <a href="{% url 'main:delete_company' company.pk %}"
         class="btn btn-sm btn-outline-danger">
        –£–¥–∞–ª–∏—Ç—å
      </a>
    </div>
  </div>

  <p>
    –†–µ–≥–∏–æ–Ω:
    <strong>{{ company.get_region_display }}</strong>
  </p>

  <p>
    –°—Ç–∞—Ç—É—Å:
    {% if company.status %}
      <strong>{{ company.status.name }}</strong>
    {% else %}
      <strong>–ë–µ–∑ —Å—Ç–∞—Ç—É—Å–∞</strong>
    {% endif %}
    {% if company.status and company.status.duration_days %}
      &nbsp;(—Ä–µ–∫–æ–º–µ–Ω–¥.: {{ company.status.duration_days }} –¥–Ω.)
    {% endif %}
    {% if days_in_status is not None %}
      , —É–∂–µ {{ days_in_status }} –¥–Ω.
    {% endif %}
  </p>

  <hr>

  {# ‚Äî‚Äî‚Äî‚Äî‚Äî –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Ä–µ–¥./—É–¥–∞–ª. –∑–∞–ø–∏—Å–∏ ‚Äî‚Äî‚Äî‚Äî‚Äî #}
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h4 class="mb-0">–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤</h4>
    <a href="{% url 'main:add_status_history' company.pk %}"
       class="btn btn-sm btn-outline-secondary">
      –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏
    </a>
  </div>

  <ul class="list-group mb-4">
    {% for h in company.history.all %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          {{ h.changed_at|date:"Y-m-d H:i" }} ‚Üí
          {% if h.status %}
            <strong>{{ h.status.name }}</strong>
          {% else %}
            <strong>–ë–µ–∑ —Å—Ç–∞—Ç—É—Å–∞</strong>
          {% endif %}
        </div>
        <div class="btn-group btn-group-sm" role="group">
          <a href="{% url 'main:edit_status_history' h.pk %}"
             class="btn btn-outline-primary"
             title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏">‚úé</a>
          <a href="{% url 'main:delete_status_history' h.pk %}"
             class="btn btn-outline-danger"
             title="–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏">üóë</a>
        </div>
      </li>
    {% empty %}
      <li class="list-group-item text-muted">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</li>
    {% endfor %}
  </ul>

  {# ‚Äî‚Äî‚Äî‚Äî‚Äî –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ‚Äî‚Äî‚Äî‚Äî‚Äî #}
  <h4>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h4>
  <ul class="list-group mb-3">
    {% for com in company.comments.all %}
      <li class="list-group-item">
        <small class="text-muted">
          {{ com.author.username }}, {{ com.created_at|date:"Y-m-d H:i" }}
        </small>
        <p class="mb-0">{{ com.text }}</p>
      </li>
    {% empty %}
      <li class="list-group-item text-muted">–ù–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</li>
    {% endfor %}
  </ul>

  <form method="post">
    {% csrf_token %}
    <div class="mb-3">
      {{ form.text.label_tag }}
      {{ form.text }}
      {{ form.text.errors }}
    </div>
    <button class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
  </form>

  <hr>

  <a href="{% url 'main:index' %}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –≤ —Å–ø–∏—Å–æ–∫</a>
</div>
{% endblock %}
